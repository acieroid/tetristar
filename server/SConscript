Import('env', 'CFLAGS')

sources = ['main.c', 'global_state.c', 'configuration.c', 'util.c',
           'network.c', 'plugins.c', 'lua_plugin.c']
sources += ['/usr/local/lib/libenet.a']
LIBS = ['lua-5.1', 'glib-2.0']

for lib in LIBS:
    env.ParseConfig('pkg-config ' + lib + ' --cflags --libs')

server = env.Program(target = 'server', source = sources,
                     # lua seems to need -lm but its .pc file doesn't say so
                     CFLAGS = CFLAGS, LIBS = LIBS + ['m'], 
                     LIBPATH = ['/usr/lib', '/usr/local/lib'])
